<app-header></app-header>

<div class="profile-container">
    <div class="profile-card">
        <div class="profile-header">
            <h2>Profil</h2>
        </div>
        <div class="profile-body">
            <div class="avatar-section">
                <p-avatar 
                    image="https://berenandor.moriczcloud.hu/storage/{{ userProfile.avatar }}" 
                    size="xlarge" 
                    shape="circle">
                </p-avatar>
            </div>
            <div class="user-info">
                <h3>{{ userProfile.name }}</h3>
                <p *ngIf="ownProfile"><strong>Email:</strong> {{ userProfile.email }}</p>
                <p><strong>Regisztráció:</strong> {{ userProfile.created_at | date }}</p>
            </div>
        </div>
        <div class="profile-actions" *ngIf="ownProfile">
            <h3>Profilkép frissítése</h3>
            <input type="file" accept="image/*" (change)="onFileSelect($event)" class="custom-file-input"/>
            <button pButton (click)="uploadAvatar()" severity="success">Feltöltés</button>
            <button pButton (click)="deleteAvatar()" severity="danger">Törlés</button>
        </div>
        <div class="profile-actions" *ngIf="ownProfile">
            <button pButton (click)="passwordChange()" severity="warn">Jelszó módosítás</button>
            <button pButton (click)="logout()" severity="danger">Kijelentkezés</button>
        </div>
        <div class="profile-actions" *ngIf="!ownProfile">
            <button pButton (click)="topics()" severity="success">Felhasználó Topic-jai</button>
        </div>
    </div>
</div>

<!-- Képvágó modal -->
<p-dialog [(visible)]="cropperDialogVisible" header="Képvágás" [modal]="true" [closable]="false" [style]="{width: '500px'}">
    <image-cropper
        [imageChangedEvent]="imageChangedEvent"
        [maintainAspectRatio]="true"
        [aspectRatio]="1 / 1"
        format="png"
        (imageCropped)="imageCropped($event)">
    </image-cropper>
    <div class="text-center">
        <button pButton (click)="cropperDialogVisible = false" severity="secondary">Mégse</button>
        <button pButton (click)="confirmCrop()" severity="success">Mentés</button>
    </div>
</p-dialog>
